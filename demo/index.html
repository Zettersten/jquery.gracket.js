<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gracket - Modern Tournament Bracket Library (v2.1)</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'BentonSans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          'Helvetica Neue', Arial, sans-serif;
        background: #0d1117;
        min-height: 100vh;
        color: #e6edf3;
      }

      .container {
        max-width: 1600px;
        margin: 0 auto;
      }

      /* ESPN-style top bar */
      .top-bar {
        background: #000000;
        border-bottom: 3px solid #c8102e;
        padding: 0.75rem 2rem;
        margin-bottom: 0;
      }

      .top-bar-content {
        max-width: 1600px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .logo {
        font-size: 1.8rem;
        font-weight: 900;
        letter-spacing: -1px;
        color: #ffffff;
        text-shadow: 2px 2px 4px rgba(200, 16, 46, 0.3);
      }

      .logo-accent {
        color: #c8102e;
      }

      .version-badge {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 700;
        letter-spacing: 0.5px;
      }

      header {
        background: linear-gradient(180deg, #1a1d29 0%, #0d1117 100%);
        padding: 3rem 2rem 2rem;
        border-bottom: 1px solid #30363d;
      }

      .header-content {
        max-width: 1600px;
        margin: 0 auto;
      }

      h1 {
        font-size: 3.5rem;
        font-weight: 900;
        margin-bottom: 0.75rem;
        color: #ffffff;
        letter-spacing: -1px;
        text-transform: uppercase;
        background: linear-gradient(135deg, #ffffff 0%, #c8102e 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        font-size: 1.3rem;
        color: #8b949e;
        margin-bottom: 2rem;
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .header-links {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .header-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: #21262d;
        border: 1px solid #30363d;
        border-radius: 4px;
        color: #e6edf3;
        text-decoration: none;
        transition: all 0.2s;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.875rem;
        letter-spacing: 0.5px;
      }

      .header-link:hover {
        background: #c8102e;
        border-color: #c8102e;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(200, 16, 46, 0.4);
      }

      .main-content {
        max-width: 1600px;
        margin: 0 auto;
        padding: 2rem 1rem;
      }

      .demo-section {
        background: #161b22;
        border: 1px solid #30363d;
        border-radius: 8px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);
      }

      .demo-section h2 {
        margin-bottom: 1rem;
        color: #ffffff;
        font-size: 1.8rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: -0.5px;
        padding-bottom: 0.75rem;
        border-bottom: 3px solid #c8102e;
        display: inline-block;
      }

      .demo-description {
        color: #8b949e;
        margin-bottom: 1.5rem;
        margin-top: 1.5rem;
        line-height: 1.7;
        font-size: 1.05rem;
      }

      .bracket-wrapper {
        overflow-x: auto;
        background: #0d1117;
        border: 2px solid #30363d;
        border-radius: 6px;
        padding: 2rem 1rem;
        margin-top: 1.5rem;
      }

      .controls {
        display: flex;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
        flex-wrap: wrap;
        padding: 1.5rem;
        background: #0d1117;
        border-radius: 6px;
        border: 1px solid #30363d;
      }

      button {
        padding: 0.875rem 1.75rem;
        border: 2px solid #c8102e;
        border-radius: 4px;
        background: transparent;
        color: #ffffff;
        font-size: 0.95rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      button:hover {
        background: #c8102e;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(200, 16, 46, 0.5);
      }

      button:active {
        transform: translateY(0);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .feature-badge {
        display: inline-block;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        margin-left: 0.5rem;
        letter-spacing: 0.5px;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin: 1.5rem 0;
      }

      .stat-card {
        background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
        padding: 1.5rem;
        border-radius: 6px;
        border: 1px solid #30363d;
        transition: all 0.3s;
      }

      .stat-card:hover {
        border-color: #667eea;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      .stat-label {
        color: #8b949e;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
        font-weight: 600;
      }

      .stat-value {
        color: #ffffff;
        font-size: 2rem;
        font-weight: 900;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .log-output {
        background: #000000;
        border: 1px solid #30363d;
        border-radius: 6px;
        padding: 1rem;
        margin-top: 1rem;
        max-height: 300px;
        overflow-y: auto;
        font-family: 'Courier New', monospace;
        font-size: 0.85rem;
        line-height: 1.6;
      }

      .log-entry {
        padding: 0.25rem 0;
        border-bottom: 1px solid #21262d;
      }

      .log-entry:last-child {
        border-bottom: none;
      }

      .log-success {
        color: #2ea043;
      }

      .log-info {
        color: #58a6ff;
      }

      .log-warning {
        color: #d29922;
      }

      .log-error {
        color: #f85149;
      }

      .team-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin: 1rem 0;
      }

      .team-chip {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.875rem;
        font-weight: 700;
      }

      .report-output {
        background: #000000;
        border: 1px solid #30363d;
        border-radius: 6px;
        padding: 1.5rem;
        margin-top: 1rem;
        font-family: 'Courier New', monospace;
        font-size: 0.85rem;
        line-height: 1.8;
        white-space: pre-wrap;
        color: #8b949e;
      }

      footer {
        text-align: center;
        padding: 3rem 2rem;
        background: #000000;
        border-top: 3px solid #c8102e;
        margin-top: 3rem;
      }

      footer p {
        color: #8b949e;
        line-height: 1.8;
      }

      footer a {
        color: #e6edf3;
        text-decoration: none;
        font-weight: 600;
        transition: color 0.2s;
      }

      footer a:hover {
        color: #c8102e;
      }

      /* Double Elimination Styles */
      .double-elim-container {
        display: flex;
        flex-direction: column;
        gap: 4rem;
        margin-top: 2rem;
        position: relative;
      }

      .bracket-section {
        position: relative;
        background: #0d1117;
        border: 2px solid #30363d;
        border-radius: 8px;
        padding: 2rem;
        overflow-x: auto;
        overflow-y: visible;
      }

      .bracket-title {
        color: #ffffff;
        font-size: 1.5rem;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 3px solid #c8102e;
        display: inline-block;
        width: 100%;
      }

      .winners-bracket {
        border-color: #2ea043;
        box-shadow: 0 0 20px rgba(46, 160, 67, 0.1);
      }

      .winners-bracket .bracket-title {
        border-bottom-color: #2ea043;
      }

      .losers-bracket {
        border-color: #f85149;
        box-shadow: 0 0 20px rgba(248, 81, 73, 0.1);
      }

      .losers-bracket .bracket-title {
        border-bottom-color: #f85149;
      }

      .grand-finals {
        max-width: 900px;
        margin: 0 auto;
        background: linear-gradient(180deg, #1a1d29 0%, #0d1117 100%);
        border-color: #ffd700;
        border-width: 3px;
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.3), inset 0 0 60px rgba(255, 215, 0, 0.05);
      }

      .grand-finals .bracket-title {
        border-bottom-color: #ffd700;
        text-align: center;
        font-size: 1.8rem;
      }

      .bracket-wrapper-inner {
        background: transparent;
        border-radius: 6px;
        padding: 1rem;
        min-height: 400px;
        position: relative;
      }

      /* Visual connectors between brackets */
      .bracket-section::before,
      .bracket-section::after {
        content: '';
        position: absolute;
        width: 3px;
        z-index: 5;
        pointer-events: none;
      }

      .winners-bracket::after {
        bottom: -4rem;
        left: 50%;
        height: 4rem;
        transform: translateX(-50%);
        background: linear-gradient(180deg, #2ea043 0%, rgba(46, 160, 67, 0.3) 50%, transparent 100%);
        box-shadow: 0 0 10px rgba(46, 160, 67, 0.4);
      }

      .losers-bracket::before {
        top: -4rem;
        left: 50%;
        height: 4rem;
        transform: translateX(-50%);
        background: linear-gradient(180deg, transparent 0%, rgba(248, 81, 73, 0.3) 50%, #f85149 100%);
        box-shadow: 0 0 10px rgba(248, 81, 73, 0.4);
      }

      .losers-bracket::after {
        bottom: -4rem;
        left: 50%;
        height: 4rem;
        transform: translateX(-50%);
        background: linear-gradient(180deg, #f85149 0%, rgba(248, 81, 73, 0.3) 50%, transparent 100%);
        box-shadow: 0 0 10px rgba(248, 81, 73, 0.4);
      }

      .grand-finals::before {
        top: -4rem;
        left: 50%;
        height: 4rem;
        transform: translateX(-50%);
        background: linear-gradient(180deg, transparent 0%, rgba(255, 215, 0, 0.3) 50%, #ffd700 100%);
        box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      }

      @media (max-width: 768px) {
        h1 {
          font-size: 2.5rem;
        }

        .demo-section {
          padding: 1.5rem;
        }

        .main-content {
          padding: 1rem;
        }

        .controls {
          flex-direction: column;
        }

        button {
          width: 100%;
        }

        .double-elim-container {
          gap: 2rem;
        }

        .bracket-section {
          padding: 1.5rem;
        }

        .bracket-title {
          font-size: 1.2rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- ESPN-style top bar -->
    <div class="top-bar">
      <div class="top-bar-content">
        <div class="logo">GRACKET<span class="logo-accent">.</span></div>
        <div class="version-badge">v2.1 - NEW FEATURES</div>
      </div>
    </div>

    <header>
      <div class="header-content">
        <h1>üèÜ Tournament Brackets</h1>
        <p class="subtitle">Modern, Framework-Agnostic Bracket Library with Advanced Features</p>
        <div class="header-links">
          <a href="https://github.com/Zettersten/jquery.gracket.js" class="header-link" target="_blank">
            <span>‚≠ê</span> GitHub
          </a>
          <a href="https://www.npmjs.com/package/gracket" class="header-link" target="_blank">
            <span>üì¶</span> NPM
          </a>
          <a href="https://github.com/Zettersten/jquery.gracket.js#readme" class="header-link" target="_blank">
            <span>üìñ</span> Docs
          </a>
        </div>
      </div>
    </header>

    <div class="main-content">
      <!-- Feature 1: Byes Support -->
      <div class="demo-section">
        <h2>üé≤ Byes Support<span class="feature-badge">NEW in v2.1</span></h2>
        <p class="demo-description">
          Handle tournaments with any number of teams - not just powers of 2! This 6-team tournament automatically
          gives byes to the top 2 seeds (Warriors & Lakers).
        </p>
        
        <div class="controls">
          <button id="load-byes-6">6 Teams (2 Byes)</button>
          <button id="load-byes-5">5 Teams (3 Byes)</button>
          <button id="load-byes-7">7 Teams (1 Bye)</button>
          <button id="load-byes-10">10 Teams (6 Byes)</button>
        </div>

        <div class="bracket-wrapper">
          <div id="byes-bracket"></div>
        </div>

        <div class="log-output" id="byes-log">
          <div class="log-entry log-info">Click a button above to load different tournament sizes</div>
        </div>
      </div>

      <!-- Feature 2: Auto-Generation & Scoring -->
      <div class="demo-section">
        <h2>üîÑ Interactive Scoring & Auto-Generation<span class="feature-badge">NEW in v2.1</span></h2>
        <p class="demo-description">
          Enter scores interactively and watch the bracket automatically advance to the next round!
          Uses tie-breaking to handle tied scores.
        </p>
        
        <div class="controls">
          <button id="enter-scores">üìù Enter Random Scores</button>
          <button id="advance-round">‚è≠Ô∏è Advance Round</button>
          <button id="auto-generate">üöÄ Auto-Generate Tournament</button>
          <button id="reset-scores">üîÑ Reset</button>
        </div>

        <div id="stats-display" class="stats-grid" style="display:none;">
          <div class="stat-card">
            <div class="stat-label">Current Round</div>
            <div class="stat-value" id="stat-current-round">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Completion</div>
            <div class="stat-value" id="stat-completion">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Avg Score</div>
            <div class="stat-value" id="stat-avg-score">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-label">Byes</div>
            <div class="stat-value" id="stat-byes">-</div>
          </div>
        </div>

        <div class="bracket-wrapper">
          <div id="scoring-bracket"></div>
        </div>

        <div class="log-output" id="scoring-log">
          <div class="log-entry log-info">Interactive scoring demo - Click "Enter Random Scores" to start!</div>
        </div>
      </div>

      <!-- Feature 3: Reporting -->
      <div class="demo-section">
        <h2>üìä Comprehensive Reporting<span class="feature-badge">NEW in v2.1</span></h2>
        <p class="demo-description">
          Generate detailed reports in multiple formats, track team history, and get tournament statistics.
        </p>
        
        <div class="controls">
          <button id="show-advancing">üë• Show Advancing Teams</button>
          <button id="show-team-history">üìà Track Warriors</button>
          <button id="generate-text-report">üìÑ Text Report</button>
          <button id="generate-json-report">{ } JSON Report</button>
          <button id="show-statistics">üìä Statistics</button>
        </div>

        <div id="advancing-teams" class="team-list" style="display:none;"></div>

        <div class="report-output" id="report-output" style="display:none;"></div>

        <div class="bracket-wrapper">
          <div id="reporting-bracket"></div>
        </div>
      </div>

      <!-- Feature 4: Complete Example -->
      <div class="demo-section">
        <h2>üéØ Complete Interactive Tournament</h2>
        <p class="demo-description">
          A full-featured tournament with all new capabilities combined: byes, scoring, auto-advancement, and reporting.
        </p>
        
        <div class="controls">
          <button id="complete-start">üé¨ Start New Tournament</button>
          <button id="complete-score">üìù Enter Match Score</button>
          <button id="complete-report">üìä Generate Full Report</button>
        </div>

        <div class="bracket-wrapper">
          <div id="complete-bracket"></div>
        </div>

        <div class="log-output" id="complete-log">
          <div class="log-entry log-info">Click "Start New Tournament" to begin!</div>
        </div>
      </div>

      <!-- Feature 5: Double Elimination Bracket -->
      <div class="demo-section">
        <h2>üèÜ Double Elimination Bracket</h2>
        <p class="demo-description">
          A complete double elimination tournament visualization. Teams start in the Winners Bracket (top). 
          Losers drop to the Losers Bracket (bottom). The Grand Finals pits the Winners Bracket champion 
          against the Losers Bracket champion - the Winners Bracket champion must lose twice to be eliminated.
        </p>
        
        <div class="double-elim-container">
          <div class="bracket-section winners-bracket">
            <h3 class="bracket-title">Winners Bracket</h3>
            <div class="bracket-wrapper-inner">
              <div id="winners-bracket"></div>
            </div>
          </div>
          
          <div class="bracket-section losers-bracket">
            <h3 class="bracket-title">Losers Bracket</h3>
            <div class="bracket-wrapper-inner">
              <div id="losers-bracket"></div>
            </div>
          </div>
          
          <div class="bracket-section grand-finals">
            <h3 class="bracket-title">Grand Finals</h3>
            <div class="bracket-wrapper-inner">
              <div id="grand-finals-bracket"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>
        Made with ‚ù§Ô∏è by Erik Zettersten<br>
        <a href="https://github.com/Zettersten/jquery.gracket.js">GitHub</a> |
        <a href="https://www.npmjs.com/package/gracket">NPM</a> |
        <a href="https://github.com/Zettersten/jquery.gracket.js#readme">Documentation</a>
      </p>
      <p style="margin-top: 1rem; font-size: 0.9rem;">
        Version 2.1.0 | MIT License | Built with TypeScript & Vite
      </p>
    </footer>

    <script type="module">
      import { Gracket, generateTournamentWithByes } from '/src/index.ts';
      import '/src/style.css';

      // ========================================================================
      // Helper Functions
      // ========================================================================

      function addLog(containerId, message, type = 'info') {
        const container = document.getElementById(containerId);
        const entry = document.createElement('div');
        entry.className = `log-entry log-${type}`;
        entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        container.appendChild(entry);
        container.scrollTop = container.scrollHeight;
      }

      function clearLog(containerId) {
        document.getElementById(containerId).innerHTML = '';
      }

      // ========================================================================
      // Demo 1: Byes Support
      // ========================================================================

      let byesBracket = null;

      function loadByesTournament(teamCount) {
        clearLog('byes-log');
        addLog('byes-log', `Loading ${teamCount}-team tournament...`, 'info');

        const teams = Array.from({ length: teamCount }, (_, i) => ({
          name: `Team ${String.fromCharCode(65 + i)}`,
          id: `team-${i}`,
          seed: i + 1
        }));

        const data = generateTournamentWithByes(teams, 'top-seeds');
        const byesNeeded = Math.pow(2, Math.ceil(Math.log2(teamCount))) - teamCount;

        addLog('byes-log', `Generated tournament with ${byesNeeded} bye(s)`, 'success');
        addLog('byes-log', `Top ${byesNeeded} seed(s) receive automatic bye(s)`, 'info');

        if (byesBracket) {
          byesBracket.destroy();
        }

        byesBracket = new Gracket('#byes-bracket', {
          src: data,
          byeLabel: 'BYE',
          roundLabels: ['Round 1', 'Round 2', 'Semifinals', 'Finals', 'Champion']
        });

        addLog('byes-log', 'Bracket rendered with bye visualizations', 'success');
      }

      document.getElementById('load-byes-6').addEventListener('click', () => loadByesTournament(6));
      document.getElementById('load-byes-5').addEventListener('click', () => loadByesTournament(5));
      document.getElementById('load-byes-7').addEventListener('click', () => loadByesTournament(7));
      document.getElementById('load-byes-10').addEventListener('click', () => loadByesTournament(10));

      // Load initial
      loadByesTournament(6);

      // ========================================================================
      // Demo 2: Interactive Scoring & Auto-Generation
      // ========================================================================

      const initialScoringTeams = [
        { name: 'Warriors', id: 'warriors', seed: 1 },
        { name: 'Lakers', id: 'lakers', seed: 2 },
        { name: 'Celtics', id: 'celtics', seed: 3 },
        { name: 'Heat', id: 'heat', seed: 4 },
        { name: 'Bucks', id: 'bucks', seed: 5 },
        { name: 'Suns', id: 'suns', seed: 6 }
      ];

      let scoringBracket = null;
      let currentRound = 0;

      function initScoringBracket() {
        clearLog('scoring-log');
        document.getElementById('stats-display').style.display = 'grid';
        
        const data = generateTournamentWithByes(initialScoringTeams, 'top-seeds');
        
        if (scoringBracket) {
          scoringBracket.destroy();
        }

        scoringBracket = new Gracket('#scoring-bracket', {
          src: data,
          byeLabel: 'BYE',
          roundLabels: ['Round 1', 'Semifinals', 'Finals', 'Champion'],
          
          onScoreUpdate: (r, g, t, score) => {
            addLog('scoring-log', `Score entered: Round ${r + 1}, Game ${g + 1}, Team ${t + 1}: ${score} pts`, 'info');
            updateStats();
          },
          
          onRoundComplete: (r) => {
            addLog('scoring-log', `Round ${r + 1} completed!`, 'success');
            const advancing = scoringBracket.getAdvancingTeams(r);
            addLog('scoring-log', `Advancing: ${advancing.map(t => t.name).join(', ')}`, 'success');
            updateStats();
          },
          
          onRoundGenerated: (r, roundData) => {
            addLog('scoring-log', `Round ${r + 1} generated with ${roundData.length} game(s)`, 'success');
            updateStats();
          }
        });

        currentRound = 0;
        updateStats();
        addLog('scoring-log', 'Tournament initialized', 'success');
      }

      function updateStats() {
        if (!scoringBracket) return;
        
        const stats = scoringBracket.getStatistics();
        const data = scoringBracket.getData();
        
        // Find current round
        let current = 0;
        for (let i = 0; i < data.length; i++) {
          if (!scoringBracket.isRoundComplete(i)) {
            current = i;
            break;
          }
        }
        
        document.getElementById('stat-current-round').textContent = current + 1;
        document.getElementById('stat-completion').textContent = `${stats.completionPercentage}%`;
        document.getElementById('stat-avg-score').textContent = stats.averageScore ? stats.averageScore.toFixed(1) : 'N/A';
        document.getElementById('stat-byes').textContent = stats.byeCount;
      }

      document.getElementById('enter-scores').addEventListener('click', () => {
        const data = scoringBracket.getData();
        
        // Find first incomplete round
        for (let r = 0; r < data.length; r++) {
          if (scoringBracket.isRoundComplete(r)) continue;
          
          const round = data[r];
          for (let g = 0; g < round.length; g++) {
            const game = round[g];
            if (game.length === 2) {
              // Regular match - add random scores
              if (game[0].score === undefined) {
                const score1 = Math.floor(Math.random() * 30) + 90;
                const score2 = Math.floor(Math.random() * 30) + 85;
                scoringBracket.updateScore(r, g, 0, score1);
                scoringBracket.updateScore(r, g, 1, score2);
                addLog('scoring-log', `Random scores: ${game[0].name} ${score1} - ${game[1].name} ${score2}`, 'info');
              }
            }
          }
          break;
        }
      });

      document.getElementById('advance-round').addEventListener('click', () => {
        const data = scoringBracket.getData();
        
        for (let r = 0; r < data.length; r++) {
          if (scoringBracket.isRoundComplete(r) && r < data.length - 1) {
            // Check if next round exists and is empty
            if (data[r + 1].every(game => game.every(team => !team.score))) {
              try {
                scoringBracket.advanceRound(r, {
                  tieBreaker: 'higher-seed',
                  createRounds: true
                });
                addLog('scoring-log', `Advanced from Round ${r + 1} to Round ${r + 2}`, 'success');
                return;
              } catch (e) {
                addLog('scoring-log', `Error: ${e.message}`, 'error');
                return;
              }
            }
          } else if (!scoringBracket.isRoundComplete(r)) {
            addLog('scoring-log', `Round ${r + 1} is not complete yet`, 'warning');
            return;
          }
        }
        
        addLog('scoring-log', 'No rounds to advance', 'warning');
      });

      document.getElementById('auto-generate').addEventListener('click', () => {
        try {
          scoringBracket.autoGenerateTournament({
            tieBreaker: 'higher-seed',
            onRoundGenerated: (idx, data) => {
              addLog('scoring-log', `Auto-generated Round ${idx + 1}`, 'success');
            }
          });
          addLog('scoring-log', 'Tournament auto-generation complete!', 'success');
        } catch (e) {
          addLog('scoring-log', `Error: ${e.message}`, 'error');
        }
      });

      document.getElementById('reset-scores').addEventListener('click', () => {
        initScoringBracket();
      });

      initScoringBracket();

      // ========================================================================
      // Demo 3: Reporting
      // ========================================================================

      const reportingTeams = [
        { name: 'Warriors', id: 'warriors', seed: 1, score: 105 },
        { name: 'Thunder', id: 'thunder', seed: 8, score: 92 },
        { name: 'Lakers', id: 'lakers', seed: 2, score: 110 },
        { name: 'Rockets', id: 'rockets', seed: 7, score: 98 },
        { name: 'Celtics', id: 'celtics', seed: 3, score: 108 },
        { name: 'Pacers', id: 'pacers', seed: 6, score: 105 },
        { name: 'Heat', id: 'heat', seed: 4, score: 112 },
        { name: 'Nets', id: 'nets', seed: 5, score: 98 }
      ];

      const reportingData = [
        [
          [
            { ...reportingTeams[0] },
            { ...reportingTeams[1] }
          ],
          [
            { ...reportingTeams[2] },
            { ...reportingTeams[3] }
          ],
          [
            { ...reportingTeams[4] },
            { ...reportingTeams[5] }
          ],
          [
            { ...reportingTeams[6] },
            { ...reportingTeams[7] }
          ]
        ],
        [
          [
            { name: 'Warriors', id: 'warriors', seed: 1, score: 118 },
            { name: 'Lakers', id: 'lakers', seed: 2, score: 105 }
          ],
          [
            { name: 'Celtics', id: 'celtics', seed: 3, score: 108 },
            { name: 'Heat', id: 'heat', seed: 4, score: 102 }
          ]
        ],
        [
          [
            { name: 'Warriors', id: 'warriors', seed: 1, score: 120 },
            { name: 'Celtics', id: 'celtics', seed: 3, score: 115 }
          ]
        ],
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1 }]
        ]
      ];

      const reportingBracket = new Gracket('#reporting-bracket', {
        src: reportingData,
        roundLabels: ['Quarterfinals', 'Semifinals', 'Finals', 'Champion']
      });

      document.getElementById('show-advancing').addEventListener('click', () => {
        const container = document.getElementById('advancing-teams');
        container.style.display = 'flex';
        container.innerHTML = '';
        
        document.getElementById('report-output').style.display = 'none';
        
        const advancing = reportingBracket.getAdvancingTeams(0);
        advancing.forEach(team => {
          const chip = document.createElement('div');
          chip.className = 'team-chip';
          chip.textContent = `${team.name} (Seed ${team.seed})`;
          container.appendChild(chip);
        });
      });

      document.getElementById('show-team-history').addEventListener('click', () => {
        const history = reportingBracket.getTeamHistory('warriors');
        
        document.getElementById('advancing-teams').style.display = 'none';
        const output = document.getElementById('report-output');
        output.style.display = 'block';
        
        let report = `=== ${history.team.name} Tournament History ===\n\n`;
        report += `Final Record: ${history.wins}W - ${history.losses}L\n`;
        report += `Final Placement: ${history.finalPlacement || 'In Progress'}\n\n`;
        report += `Match-by-Match:\n`;
        
        history.matches.forEach((match, i) => {
          const result = match.won ? '‚úì WIN ' : '‚úó LOSS';
          const opponent = match.isBye ? 'BYE' : match.opponent?.name;
          const scoreDetail = match.score && match.opponentScore 
            ? ` (${match.score}-${match.opponentScore})` 
            : '';
          report += `  ${i + 1}. ${match.roundLabel}: ${result} vs ${opponent}${scoreDetail}\n`;
        });
        
        output.textContent = report;
      });

      document.getElementById('generate-text-report').addEventListener('click', () => {
        document.getElementById('advancing-teams').style.display = 'none';
        const output = document.getElementById('report-output');
        output.style.display = 'block';
        
        const report = reportingBracket.generateReport({
          format: 'text',
          includeScores: true,
          includeStatistics: true
        });
        
        output.textContent = report;
      });

      document.getElementById('generate-json-report').addEventListener('click', () => {
        document.getElementById('advancing-teams').style.display = 'none';
        const output = document.getElementById('report-output');
        output.style.display = 'block';
        
        const report = reportingBracket.generateReport({ format: 'json' });
        output.textContent = JSON.stringify(report, null, 2);
      });

      document.getElementById('show-statistics').addEventListener('click', () => {
        const stats = reportingBracket.getStatistics();
        
        document.getElementById('advancing-teams').style.display = 'none';
        const output = document.getElementById('report-output');
        output.style.display = 'block';
        
        let report = '=== Tournament Statistics ===\n\n';
        report += `Participants: ${stats.participantCount}\n`;
        report += `Total Rounds: ${stats.totalRounds}\n`;
        report += `Byes: ${stats.byeCount}\n`;
        report += `Average Score: ${stats.averageScore?.toFixed(1) || 'N/A'}\n`;
        report += `Completion: ${stats.completionPercentage}%\n`;
        
        if (stats.highestScore) {
          report += `\nHighest Score:\n`;
          report += `  ${stats.highestScore.team.name} scored ${stats.highestScore.score}\n`;
          report += `  in round ${stats.highestScore.round + 1}\n`;
        }
        
        output.textContent = report;
      });

      // ========================================================================
      // Demo 4: Complete Interactive Tournament
      // ========================================================================

      let completeBracket = null;

      document.getElementById('complete-start').addEventListener('click', () => {
        clearLog('complete-log');
        
        const teams = [
          { name: 'Warriors', id: 'warriors', seed: 1 },
          { name: 'Lakers', id: 'lakers', seed: 2 },
          { name: 'Celtics', id: 'celtics', seed: 3 },
          { name: 'Heat', id: 'heat', seed: 4 },
          { name: 'Bucks', id: 'bucks', seed: 5 },
          { name: 'Suns', id: 'suns', seed: 6 },
          { name: 'Nets', id: 'nets', seed: 7 }
        ];
        
        const data = generateTournamentWithByes(teams, 'top-seeds');
        
        if (completeBracket) {
          completeBracket.destroy();
        }
        
        completeBracket = new Gracket('#complete-bracket', {
          src: data,
          byeLabel: 'BYE',
          roundLabels: ['Round 1', 'Semifinals', 'Finals', 'Champion'],
          
          onScoreUpdate: (r, g, t, score) => {
            addLog('complete-log', `Score: ${score}`, 'info');
          },
          
          onRoundComplete: (r) => {
            const advancing = completeBracket.getAdvancingTeams(r);
            addLog('complete-log', `Round ${r + 1} complete! Advancing: ${advancing.map(t => t.name).join(', ')}`, 'success');
          }
        });
        
        addLog('complete-log', '7-team tournament started with byes for top seed', 'success');
      });

      document.getElementById('complete-score').addEventListener('click', () => {
        if (!completeBracket) {
          addLog('complete-log', 'Start a tournament first!', 'warning');
          return;
        }
        
        const data = completeBracket.getData();
        
        // Enter scores for first incomplete match
        for (let r = 0; r < data.length; r++) {
          if (completeBracket.isRoundComplete(r)) continue;
          
          const round = data[r];
          for (let g = 0; g < round.length; g++) {
            const game = round[g];
            if (game.length === 2 && !game[0].score) {
              const score1 = Math.floor(Math.random() * 30) + 90;
              const score2 = Math.floor(Math.random() * 30) + 85;
              
              completeBracket.updateScore(r, g, 0, score1);
              completeBracket.updateScore(r, g, 1, score2);
              
              addLog('complete-log', `Match scored: ${game[0].name} ${score1} - ${game[1].name} ${score2}`, 'info');
              
              // Auto-advance if round complete
              if (completeBracket.isRoundComplete(r)) {
                completeBracket.advanceRound(r, {
                  tieBreaker: 'higher-seed',
                  createRounds: true
                });
              }
              return;
            }
          }
        }
        
        addLog('complete-log', 'All matches have scores!', 'info');
      });

      document.getElementById('complete-report').addEventListener('click', () => {
        if (!completeBracket) {
          addLog('complete-log', 'Start a tournament first!', 'warning');
          return;
        }
        
        const report = completeBracket.generateReport({
          format: 'text',
          includeScores: true,
          includeStatistics: true
        });
        
        addLog('complete-log', '\\n' + report, 'success');
      });

      // ========================================================================
      // Demo 5: Double Elimination Bracket
      // ========================================================================

      // 8-team double elimination tournament data
      const doubleElimTeams = [
        { name: 'Warriors', id: 'warriors', seed: 1 },
        { name: 'Lakers', id: 'lakers', seed: 2 },
        { name: 'Celtics', id: 'celtics', seed: 3 },
        { name: 'Heat', id: 'heat', seed: 4 },
        { name: 'Bucks', id: 'bucks', seed: 5 },
        { name: 'Suns', id: 'suns', seed: 6 },
        { name: 'Nets', id: 'nets', seed: 7 },
        { name: 'Nuggets', id: 'nuggets', seed: 8 }
      ];

      // Winners Bracket (8 teams -> 4 -> 2 -> 1 champion)
      const winnersBracketData = [
        // Round 1: Quarterfinals (4 matches)
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1, score: 105 }, { name: 'Nuggets', id: 'nuggets', seed: 8, score: 92 }],
          [{ name: 'Lakers', id: 'lakers', seed: 2, score: 98 }, { name: 'Nets', id: 'nets', seed: 7, score: 110 }],
          [{ name: 'Celtics', id: 'celtics', seed: 3, score: 108 }, { name: 'Suns', id: 'suns', seed: 6, score: 102 }],
          [{ name: 'Heat', id: 'heat', seed: 4, score: 95 }, { name: 'Bucks', id: 'bucks', seed: 5, score: 112 }]
        ],
        // Round 2: Semifinals (2 matches)
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1, score: 118 }, { name: 'Nets', id: 'nets', seed: 7, score: 105 }],
          [{ name: 'Celtics', id: 'celtics', seed: 3, score: 115 }, { name: 'Bucks', id: 'bucks', seed: 5, score: 108 }]
        ],
        // Round 3: Finals (1 match)
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1, score: 120 }, { name: 'Celtics', id: 'celtics', seed: 3, score: 115 }]
        ],
        // Round 4: Champion
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1 }]
        ]
      ];

      // Losers Bracket (losers from winners bracket feed in)
      // Structure: Round 1 losers play each other, then winners play Round 2 losers, etc.
      const losersBracketData = [
        // Round 1: First round losers (4 teams -> 2)
        [
          [{ name: 'Nuggets', id: 'nuggets', seed: 8, score: 88 }, { name: 'Lakers', id: 'lakers', seed: 2, score: 95 }],
          [{ name: 'Suns', id: 'suns', seed: 6, score: 102 }, { name: 'Heat', id: 'heat', seed: 4, score: 98 }]
        ],
        // Round 2: Losers from Winners Round 2 + Winners from Losers Round 1 (4 teams -> 2)
        [
          [{ name: 'Lakers', id: 'lakers', seed: 2, score: 92 }, { name: 'Nets', id: 'nets', seed: 7, score: 105 }],
          [{ name: 'Suns', id: 'suns', seed: 6, score: 98 }, { name: 'Bucks', id: 'bucks', seed: 5, score: 110 }]
        ],
        // Round 3: Semifinals (2 teams -> 1)
        [
          [{ name: 'Nets', id: 'nets', seed: 7, score: 108 }, { name: 'Bucks', id: 'bucks', seed: 5, score: 112 }]
        ],
        // Round 4: Finals (loser plays winner from previous round)
        [
          [{ name: 'Nets', id: 'nets', seed: 7, score: 115 }, { name: 'Celtics', id: 'celtics', seed: 3, score: 118 }]
        ],
        // Round 5: Losers Bracket Champion
        [
          [{ name: 'Celtics', id: 'celtics', seed: 3 }]
        ]
      ];

      // Grand Finals: Winners Bracket Champion vs Losers Bracket Champion
      const grandFinalsData = [
        // Grand Finals Match 1
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1, score: 125 }, { name: 'Celtics', id: 'celtics', seed: 3, score: 120 }]
        ],
        // Grand Finals Match 2 (if needed - Warriors already won, so this is just for display)
        [
          [{ name: 'Warriors', id: 'warriors', seed: 1 }]
        ]
      ];

      // Initialize Winners Bracket
      const winnersBracket = new Gracket('#winners-bracket', {
        src: winnersBracketData,
        roundLabels: ['Quarterfinals', 'Semifinals', 'Finals', 'Champion'],
        canvasLineColor: '#2ea043'
      });

      // Initialize Losers Bracket
      const losersBracket = new Gracket('#losers-bracket', {
        src: losersBracketData,
        roundLabels: ['Round 1', 'Round 2', 'Semifinals', 'Finals', 'Champion'],
        canvasLineColor: '#f85149'
      });

      // Initialize Grand Finals
      const grandFinalsBracket = new Gracket('#grand-finals-bracket', {
        src: grandFinalsData,
        roundLabels: ['Grand Finals', 'Champion'],
        canvasLineColor: '#ffd700'
      });
    </script>
  </body>
</html>
